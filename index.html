<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"/>
    <link rel="stylesheet" href="assets/css/style.css"/>
</head>
<body>

<div class="main_container">
    <div id="welcome">
        <h5 class="top_banner">Welcome to TSD practice.</h5>
        <div class="inner_block">
            <div class="block_container">
                <span class="choose">Rank</span>
                <div class="dropdown">
                    <div class="select">
                        <span id="rank">Select Rank</span>
                        <i class="fa fa-chevron-left"></i>
                    </div>
                    <ul class="dropdown-menu">
                        <li>10th Gup</li>
                        <li>9th Gup</li>
                        <li>8th Gup</li>
                        <li>7th Gup</li>
                        <li>6th Gup</li>
                        <li>5th Gup</li>
                        <li>4th Gup</li>
                        <li>3th Gup</li>
                        <li>2nd Gup</li>
                        <li>1st Gup</li>
                        <li>Cho Dan Bo</li>                        
                    </ul>
                </div>
            </div>
            <div class="block_container">
                <!-- // TBD: Clean -->
                <span class="choose">Practice Time</span>
                <div class="dropdown">
                    <div class="select">
                        <span id="practice_time">Practice Time</span>
                        <i class="fa fa-chevron-left"></i>
                    </div>
                    <ul class="dropdown-menu">
                        <li>1 Minutes</li>
                        <li>5 Minutes</li>
                        <li>15 Minutes</li>
                        <li>30 Minutes</li> 
                        <li>60 Minutes</li> 
                        <li>90 Minutes</li>                      
                    </ul>
                </div>
            </div>
            <div class="block_container">
                <button disabled class="custom-btn btn-3" id="start_button"><span>Start / Shi Jak</span></button>
            </div>
            <h5 class="feedback"><a href = "mailto: victor.ronin@gmail.com?subject=TSDPractice">Feedback</a></h5>
        </div>
    </div>
    <div id="practice" style="display: none;">
        <div class="inner_block">
            <div class="block_container">
                <h4 class="page-sub-title" id="technique_type"></h4>                
                <h4 class="page-title" id="technique_name"></h4>
                <h4 class="seconds-timer" >Exercise time left <span id="technique_timer"></span> Seconds</h4>
            </div>
            <h5 class="main-timer" id="main_timer"></h5>
            <h5 class="feedback"><a href = "mailto: victor.ronin@gmail.com?subject=TSDPractice">Feedback</a></h5>
        </div>
    </div>
    <div id="thankyou" style="display: none;">
        <div class="inner_block">
            <div class="block_container">
                <h4 class="thanks_text">Thank you for the practice.</h4>
            </div>
            <h5 class="feedback"><a href = "mailto: victor.ronin@gmail.com?subject=TSDPractice">Feedback</a></h5>
        </div>
    </div>
</div>


<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
  crossorigin="anonymous"></script>
<script>
    $(document).ready(function () {
        // Open & close dropdown menus
        $('.dropdown').click(function () {
           $(this).toggleClass('active');
           $(this).find('.dropdown-menu').slideToggle(300);
        });
        $('.dropdown').focusout(function () {
            $(this).removeClass('active');
            $(this).find('.dropdown-menu').slideUp(300);
        });
        $('.dropdown .dropdown-menu li').click(function () {
            // Set span in parent to value of current item
            var selected_text = $(this).text()
            $(this).parents('.dropdown').find('span').text(selected_text);
            var values_picked = $('#rank').text() !== 'Select Rank' && $('#practiÑe_time').text() !== 'Practice Time';
            $('#start_button').prop('disabled', !values_picked);
        });
        $('#start_button').click(function (e) {
            e.preventDefault();
            $('#welcome').fadeOut(250);
            $('#practice').fadeIn(250);
            start_practice();
        });

        var techniques = [
            // Blocks
            { "name": "Low Block / Ha Dan Makh Ki", "rank": "10", "time_cap": 30, "type": "Line Drill"},
            { "name": "High Block / San Dan Makh Ki", "rank": "10", "time_cap": 30, "type": "Line Drill" },
            { "name": "Inside To Outside Block / Ahneso Pahkuro Mahk Ki", "rank": "9", "time_cap": 30, "type": "Line Drill" },
            { "name": "Outside To Inside Block / Pahkeso Ahnuro Mahk Ki", "rank": "9", "time_cap": 30, "type": "Line Drill" },
            { "name": "Side Block / Yup Mahk Ki", "rank": "9", "time_cap": 30, "type": "Line Drill"},
            { "name": "High Knife Hand Block", "rank": "8", "time_cap": 30, "type": "Line Drill"},
            { "name": "Center Knife Hand Block", "rank": "8", "time_cap": 30, "type": "Line Drill"},
            { "name": "Low Knife Hand Block", "rank": "8", "time_cap": 30, "type": "Line Drill" },
            { "name": "Reinforced Defence", "rank": "7", "time_cap": 30, "type": "Line Drill"},
            { "name": "Low Two-Hand X Block", "rank": "6", "time_cap": 30, "type": "Line Drill"},
            { "name": "High Two-Hand X Block", "rank": "6", "time_cap": 30, "type": "Line Drill" },

            // Strikes
            { "name": "Low Punch / Ha Dan Kong Kyuck", "rank": "9", "time_cap": 30, "type": "Line Drill" },
            { "name": "Center Punch / Choong Dan Kong Kyuck", "rank": "10", "time_cap": 30, "type": "Line Drill" },
            { "name": "High Punch / San Dan Kong Kyuck", "rank": "9", "time_cap": 30, "type": "Line Drill" },            
            { "name": "Side Punch / Choong Dan Hang Jin", "rank": "9", "time_cap": 30, "type": "Line Drill" },
            { "name": "Ridge Hand Strike", "rank": "8", "time_cap": 30, "type": "Line Drill" },
            { "name": "Elbow Strike", "rank": "8", "time_cap": 30, "type": "Line Drill" },
            { "name": "Spear hand punch", "rank": "7", "time_cap": 30, "type": "Line Drill" },

            // Kicks
            { "name": "Front Kick / Ahp Cha Ki", "rank": "10", "time_cap": 30, "type": "Line Drill" },
            { "name": "Round House Kick / Tollyo Cha Ki", "rank": "10", "time_cap": 30, "type": "Line Drill" },
            { "name": "Side Kick  / Yup Cha Ki", "rank": "10", "time_cap": 30, "type": "Line Drill" },
            { "name": "Back Kick  / Dwi Cha Ki", "rank": "10", "time_cap": 30, "type": "Line Drill" },
            { "name": "Stepping Side Kick", "rank": "9", "time_cap": 30, "type": "Line Drill" },
            { "name": "Axe Kick", "rank": "9", "time_cap": 30, "type": "Line Drill" },            
            { "name": "Spinning Back Kick / Dwi Tollyo Cha Ki", "rank": "8", "time_cap": 30, "type": "Line Drill" },
            { "name": "Crescent Kick", "rank": "8", "time_cap": 30, "type": "Line Drill" },
            { "name": "Hook Kick", "rank": "7", "time_cap": 30, "type": "Line Drill" },
            { "name": "Wheel Kick", "rank": "7", "time_cap": 30, "type": "Line Drill" },
            { "name": "Jumping Front Kick", "rank": "6", "time_cap": 30, "type": "Line Drill" },
            { "name": "Jumping Round House Kick", "rank": "6", "time_cap": 30, "type": "Line Drill" },
            { "name": "Jumping Side Kick", "rank": "6", "time_cap": 30, "type": "Line Drill" },
            { "name": "Flying kick", "rank": "3", "time_cap": 30, "type": "Line Drill" },

            // Combination
            { "name": "Yuk Soo", "rank": "5", "time_cap": 30, "type": "Line Drill" },
            { "name": "Yuk Jin", "rank": "5", "time_cap": 30, "type": "Line Drill" },

            // One-step (Hand)
            { "name": "One-steps Hands #1-2", "rank": "10", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Hands #3-4", "rank": "9", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Hands #5-6", "rank": "8", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Hands #7-8", "rank": "7", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Hands #9-10", "rank": "6", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Hands #11-12", "rank": "5", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Hands #13-14", "rank": "4", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Hands #15-16", "rank": "3", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Hands #17-18", "rank": "2", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Hands #19-20", "rank": "1", "time_cap": 30, "type": "Line Drill" },

            // One-step (Kicks)
            { "name": "One-steps Kicks #1-2", "rank": "10", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Kicks #3-4", "rank": "9", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Kicks #5-6", "rank": "8", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Kicks #7-8", "rank": "7", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Kicks #9-10", "rank": "6", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Kicks #11-12", "rank": "5", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Kicks #13-14", "rank": "4", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Kicks #15-16", "rank": "3", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Kicks #17-18", "rank": "2", "time_cap": 30, "type": "Line Drill" },
            { "name": "One-steps Kicks #19-20", "rank": "1", "time_cap": 30, "type": "Line Drill" },

            // Self-defence
            { "name": "Self-Defence #1-2", "rank": "10", "time_cap": 30, "type": "Line Drill" },
            { "name": "Self-Defence #3-4", "rank": "9", "time_cap": 30, "type": "Line Drill" },
            { "name": "Self-Defence #5-6", "rank": "8", "time_cap": 30, "type": "Line Drill" },
            { "name": "Self-Defence #7-8", "rank": "7", "time_cap": 30, "type": "Line Drill" },
            { "name": "Self-Defence #9-10", "rank": "6", "time_cap": 30, "type": "Line Drill" },
            { "name": "Self-Defence #11-12", "rank": "5", "time_cap": 30, "type": "Line Drill" },
            { "name": "Self-Defence #13-14", "rank": "4", "time_cap": 30, "type": "Line Drill" },
            { "name": "Self-Defence #15-16", "rank": "3", "time_cap": 30, "type": "Line Drill" },
            { "name": "Self-Defence #17-18", "rank": "2", "time_cap": 30, "type": "Line Drill" },
            { "name": "Self-Defence #19-20", "rank": "1", "time_cap": 30, "type": "Line Drill" },

            // Form
            { "name": "Sae Kye Hyung Il Bu", "rank": "10", "time_cap": 60, "type": "Form / Hyung" },
            { "name": "Sae Kye Hyung E Bu", "rank": "9", "time_cap": 60, "type": "Form / Hyung" },
            { "name": "Sae Kye Hyung Sam Bu", "rank": "8", "time_cap": 60, "type": "Form / Hyung" },
            { "name": "Pyung Ahn Cho Dan", "rank": "7", "time_cap": 80, "type": "Form / Hyung" },            
            { "name": "Pyung Ahn E Dan", "rank": "6", "time_cap": 80, "type": "Form / Hyung" },
            { "name": "Pyung Ahn Sam Dan", "rank": "5", "time_cap": 80, "type": "Form / Hyung" }, 
            { "name": "Pyung Ahn Sah Dan", "rank": "4", "time_cap": 80, "type": "Form / Hyung" },
            { "name": "Pyung Ahn Oh Dan", "rank": "3", "time_cap": 80, "type": "Form / Hyung" }, 
            { "name": "Bassai", "rank": "2", "time_cap": 90, "type": "Form / Hyung"},
            { "name": "Bong Hyung Il Bu", "rank": "2", "time_cap": 80, "type": "Form / Hyung" }, 
            { "name": "Hainhanchi Cho Dan", "rank": "1", "time_cap": 80, "type": "Form / Hyung" },
            { "name": "Bong Hyung E Bu", "rank": "1", "time_cap": 90, "type": "Form / Hyung" }, 
            { "name": "Sip Soo", "rank": "0", "time_cap": 80, "type": "Form / Hyung"}, 
        ]

        practice_time_tag = $('#practice_time');
        technique_type_tag = $('#technique_type');        
        technique_name_tag = $('#technique_name');
        technique_timer_tag = $('#technique_timer');
        main_timer_tag = $('#main_timer');
        rank_tag = $('#rank');
        
        function update_timers_text(practice_time_left, technique_time_left) {
            $(technique_timer_tag).text(technique_time_left);
            $(main_timer_tag).text("Practice time left: "+Math.floor(practice_time_left / 60) + " Minutes "+practice_time_left % 60+" Seconds")
        }

        function update_technique() {
            var random_technique = Math.floor(Math.random() * techniques.length)
            $(technique_name_tag).text(techniques[random_technique].name);
            $(technique_type_tag).text(techniques[random_technique].type);

            return techniques[random_technique].time_cap;
        }

        function start_practice() {
            // Overal practice
            // TBD: Clean
            var practice_time_left = parseInt(practice_time_tag.text().replace('Minutes', '').trim()) * 60;            
            var rank_text = rank_tag.text().replace(/[^0-9]/g,'');
            var rank = parseInt(rank_text); 
            if (isNaN(rank)) { rank = 0; }
            
            // Technique
            techniques = techniques.filter(
                technique => parseInt(technique.rank) >= rank
            );
            var technique_time_left = update_technique();
            update_timers_text(practice_time_left, technique_time_left);
            
            var secInterval = setInterval(function () {
                technique_time_left = technique_time_left - 1;
                practice_time_left = practice_time_left - 1;

                update_timers_text(practice_time_left, technique_time_left);

                if (technique_time_left == 0) {
                    technique_time_left = update_technique();
                }

                if (practice_time_left == 0) {
                    // Finish practice
                    clearInterval(secInterval);
                    $('#practice').fadeOut(250);
                    $('#thankyou').fadeIn(250);                    
                }
                
            }, 1000);
        }
    })
</script>
</body>
</html>
