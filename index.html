<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"/>
    <link rel="stylesheet" href="assets/css/style.css"/>
</head>
<body>

<div class="main_container">
    <div id="welcome">
        <div class="inner_block">
            <div class="block_container">
                <span class="choose">Rank</span>
                <div class="dropdown">
                    <div class="select">
                        <span class="rank">Select Gender</span>
                        <i class="fa fa-chevron-left"></i>
                    </div>
                    <input type="hidden" name="gender">
                    <ul class="dropdown-menu">
                        <li id="male">Male</li>
                        <li id="female">Female</li>
                    </ul>
                </div>
            </div>
            <div class="block_container">
                <span class="choose">practise time</span>
                <div class="dropdown">
                    <div class="select">
                        <span class="practise-time">practise time</span>
                        <i class="fa fa-chevron-left"></i>
                    </div>
                    <input type="hidden" name="gender" class="minutes-input">
                    <ul class="dropdown-menu">
                        <li id="5 Minutes">5 Minutes</li>
                        <li id="15 Minutes">15 Minutes</li>
                        <li id="30 Minutes">30 Minutes</li> 
                        <li id="60 Minutes">60 Minutes</li> 
                        <li id="90 Minutes">90 Minutes</li>                      
                    </ul>
                </div>
            </div>
            <div class="block_container">
                <button disabled class="custom-btn btn-3"><span>Submit</span></button>
            </div>
        </div>
    </div>
    <div id="practice">
        <div class="inner_block">
            <div class="block_container">
                <h4 class="page-title" id="technique_name"></h4>
                <h4 class="seconds-timer" id="technique_timer"></h4>
            </div>
            <h5 class="main-timer" id="main_timer"></h5>
            <h5 class="topbar-text" id="technique_rank"></h5>
        </div>
    </div>
    <div id="thankyou">
        <div class="inner_block">
            <div class="block_container">
                <h4 class="thanks_text">Thank you for the practice.</h4>
            </div>
        </div>
    </div>
</div>


<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
  crossorigin="anonymous"></script>
<script>
    $(document).ready(function () {
        /*Dropdown Menu*/
        $('.dropdown').click(function () {
            $(this).attr('tabindex', 1).focus();
            $(this).toggleClass('active');
            $(this).find('.dropdown-menu').slideToggle(300);
        });
        $('.dropdown').focusout(function () {
            $(this).removeClass('active');
            $(this).find('.dropdown-menu').slideUp(300);
        });
        $('.dropdown .dropdown-menu li').click(function () {
            $(this).parents('.dropdown').find('span').text($(this).text());
            $(this).parents('.dropdown').find('input').attr('value', $(this).attr('id'));
            if ($('.rank').text() !== 'Select Gender' && $('.practise-time').text() !== 'practise time') {
                $('.custom-btn').prop('disabled', false);
            } else {
                $('.custom-btn').prop('disabled', true);
            }
        });
        $('.custom-btn').click(function (e) {
            e.preventDefault();
            $('#welcome').fadeOut(250);
            $('#practice').fadeIn(250);
            f();
        });

        var techniques = [
            {
                "name": "Low Block / Ha Dan Makh Ki",
                "rank": "10 Gup",
            },
            {
                "name": "Side Punch / Choong Dan Han Jin",
                "rank": "9 Gup",
            }
        ]

        technique_name = $("#technique_name");
        technique_rank = $("#technique_rank");
        technique_timer = $('#technique_timer');
        main_timer = $('#main_timer');
        

        function update_timers_text(practice_time_left, technique_time_left) {
            $(technique_timer).text(technique_time_left + " Seconds Left");
            $(main_timer).text(Math.floor(practice_time_left / 60) + " Minutes "+practice_time_left % 60 + " Left")
        }

        function update_technique() {
            var random_technique = Math.floor(Math.random() * techniques.length)
            $(technique_name).text(techniques[random_technique].name);
            $(technique_rank).text(techniques[random_technique].rank);
        }

        function f() {
            // Overal practice
            var practice_time_left = parseInt($('.minutes-input').val().replace('Minutes', '').trim()) * 60;            
            
            // Technique
            var technique_time_cap = 30;
            var technique_time_left = technique_time_cap;

            update_timers_text(practice_time_left, technique_time_left);
            update_technique();

            var secInterval = setInterval(function () {
                technique_time_left = technique_time_left - 1;
                practice_time_left = practice_time_left - 1;

                update_timers_text(practice_time_left, technique_time_left);

                if (technique_time_left == 0) {
                    technique_time_left = technique_time_cap;
                    update_technique();
                }

                if (practice_time_left == 0) {
                    // Finish practice
                    clearInterval(secInterval);
                    $('#practice').fadeOut(250);
                    $('#thankyou').fadeIn(250);                    
                }
                
            }, 1000);
        }
    })
</script>
</body>
</html>
